# QA-Task (Persian RAG / QA)

Summary
-------
This repository contains code and data for a Persian QA / RAG evaluation (Tasks A, B, and C as described in [Task.pdf](Task.pdf)). The dataset `qadata/drugs_aq_dataset.json` was generated by ChatGPT for RAG evaluation; its text and answer spans were extracted from [qadata/Drugs.pdf](qadata/Drugs.pdf).

Key files
---------
- [Task.pdf](Task.pdf) — task description (A / B / C).
- [task1.ipynb](task1.ipynb) — exploratory notebook and Task A workflow.
- [task2.py](task2.py) — main scripts for chunking, retrieval, fine-tuning, and evaluation.
- [qadata/drugs_aq_dataset.json](qadata/drugs_aq_dataset.json) — ChatGPT-generated evaluation set (RAG).
- [qadata/Drugs.pdf](qadata/Drugs.pdf) — source PDF used to extract contexts and answers.
- [qadata/models/finetuned-emb](qadata/models/finetuned-emb) — fine-tuned embedding model artifacts.
- [outputs/task_b_results.json](outputs/task_b_results.json) —  saved evaluation results.

Important functions (see [task2.py](task2.py))
----------------------------------------------
- [`task2.extract_pdf_text`](task2.py) — extracts and normalizes text from PDF.
- [`task2.normalize_persian`](task2.py) — Persian text normalization helper.
- [`task2.map_to_squad`](task2.py) — maps dataset entries to SQuAD-like format.
- [`task2.word_based_chunk`](task2.py) — word-based chunking implementation.
- [`task2.comprehensive_evaluation`](task2.py) — runs retrieval + QA evaluation and aggregates metrics.
- [`task2.rag_pipeline`](task2.py) — end-to-end RAG retrieval + generation pipeline.
- [`task2.answer_question`](task2.py) — wrapper to generate answers given context.

Usage (quick)
-------------
1. Make sure dependencies from `req.txt`   are installed.
2. Place PDF and dataset under `qadata/` (already present here).
3. Run the main script:
   - Task B / evaluation: run `python task2.py` (scripts print progress and save results to `outputs/`).
   - Task A (generation / fine-tuning) is demonstrated in [task1.ipynb](task1.ipynb).

Notes
-----
- `qadata/drugs_aq_dataset.json` was generated by ChatGPT specifically for evaluation; contexts and annotated answers were extracted from [qadata/Drugs.pdf](qadata/Drugs.pdf).
- The repository implements multiple chunking strategies (word / sentence / semantic) and hybrid retrieval (BM25, TF-IDF, embeddings). See the referenced functions in [task2.py](task2.py) for details.
- Results for Task B are stored in [outputs/task_b_results.json](outputs/task_b_results.json).

Contact
-------
See code comments and function docstrings in [task2.py](task2.py) and the notebook [task1.ipynb](task1.ipynb) for implementation details.